<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‚¡ç¥¨äº¤æ˜“å¤ç›˜</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <style>
        :root {
            --primary: #2563eb;
            --profit: #ef4444;
            --loss: #22c55e;
            --bg: #f4f7f9;
            --card: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
        }

        * { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
        body { background: var(--bg); margin: 0; color: var(--text-main); -webkit-tap-highlight-color: transparent; }

        /* å“åº”å¼å¯¼èˆª */
        .navbar { 
            background: #fff; padding: 0.75rem 1rem; display: flex; 
            justify-content: space-between; align-items: center;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 100;
        }
        .nav-links { display: flex; gap: 8px; }
        .nav-links button { 
            background: #f8fafc; border: 1px solid #e2e8f0; color: var(--text-muted);
            padding: 0.5rem 0.8rem; border-radius: 8px; cursor: pointer; font-size: 0.9rem;
        }
        .nav-links button.active { background: var(--primary); color: white; border-color: var(--primary); }

        .container { max-width: 1100px; margin: 1rem auto; padding: 0 0.8rem; }

        /* å¡ç‰‡è®¾è®¡ */
        .card { 
            background: var(--card); padding: 1.2rem; border-radius: 12px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.03); margin-bottom: 1rem;
        }

        /* ç»Ÿè®¡æ•°å­—ï¼šç§»åŠ¨ç«¯è‡ªåŠ¨å•åˆ—æˆ–åŒåˆ— */
        .stats-grid { 
            display: grid; 
            grid-template-columns: repeat(2, 1fr); /* é»˜è®¤ä¸¤åˆ— */
            gap: 0.8rem; 
            margin-bottom: 1rem; 
        }
        
        /* æ‰‹æœºç«¯ç¬¬ä¸€ä¸ªç»Ÿè®¡å¡ç‰‡å æ»¡æ•´è¡Œï¼ˆå¼ºè°ƒæ€»èµ„äº§ï¼‰ */
        .stat-item:first-child { grid-column: span 2; }
        
        .stat-item { background: var(--card); padding: 1rem; border-radius: 12px; text-align: center; border: 1px solid #f1f5f9; }
        .stat-label { font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.4rem; }
        .stat-value { font-size: 1.3rem; font-weight: 800; }

        /* å›¾è¡¨å®¹å™¨ï¼šæ‰‹æœºä¸Šé«˜åº¦è°ƒå°ä¸€ç‚¹ */
        .chart-container { position: relative; height: 300px; width: 100%; }

        /* ç§»åŠ¨ç«¯è¡¨æ ¼é€‚é…ï¼šæ°´å¹³æ»šåŠ¨ */
        .table-wrapper { 
            overflow-x: auto; 
            -webkit-overflow-scrolling: touch; /* æµç•…æ»šåŠ¨ */
            margin: 0 -1.2rem; /* è´Ÿè¾¹è·è®©æ»šåŠ¨æ¡è§¦åŠè¾¹ç¼˜ */
            padding: 0 1.2rem;
        }
        table { width: 100%; border-collapse: collapse; min-width: 500px; /* ä¿è¯è¡¨æ ¼å†…å®¹ä¸è¢«æŒ¤å‹ */ }
        th { background: #f8fafc; text-align: left; padding: 10px; font-size: 0.8rem; color: var(--text-muted); }
        td { padding: 10px; border-bottom: 1px solid #f8fafc; font-size: 0.9rem; }

        /* å†å²è®°å½•åˆ—è¡¨é¡¹ */
        .history-item { 
            display: flex; justify-content: space-between; padding: 1.1rem;
            border: 1px solid #e2e8f0; border-radius: 10px; margin-bottom: 0.8rem;
            background: white; align-items: center;
        }

        /* è¯¦æƒ…é¡µæ—¥æœŸé€‰æ‹© */
        .date-header {
            display: flex; flex-direction: column; gap: 0.8rem; margin-bottom: 1rem;
        }
        input[type="date"] { 
            width: 100%; height: 44px; /* ç§»åŠ¨ç«¯æ‰‹æŒ‡é«˜åº¦ */
            border: 1px solid #ddd; border-radius: 8px; padding: 0 10px; font-size: 1rem;
        }

        .profit { color: var(--profit); }
        .loss { color: var(--loss); }
        .badge { padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; color: white; }

        /* åª’ä½“æŸ¥è¯¢ï¼šé€‚é…å±å¹•å®½åº¦å°äº 480px çš„æ‰‹æœº */
        @media (max-width: 480px) {
            .stat-value { font-size: 1.1rem; }
            .navbar { padding: 0.6rem 0.8rem; }
            .logo { font-size: 1.1rem !important; }
            .chart-container { height: 250px; }
        }
    </style>
</head>
<body>

<nav class="navbar">
    <div class="logo" style="font-weight: 900; color: var(--primary); font-size: 1.2rem;">TRADE LOG</div>
    <div class="nav-links">
        <button id="nav-home" class="active" onclick="switchView('home')">æ±‡æ€»</button>
        <button id="nav-detail" onclick="switchView('detail')">è¯¦æƒ…</button>
    </div>
</nav>

<div class="container">
    <div id="view-home">
        <div class="stats-grid">
            <div class="stat-item"><div class="stat-label">æ€»å‡€å€¼</div><div class="stat-value">Â¥108,330</div></div>
            <div class="stat-item"><div class="stat-label">æœ¬æœˆç›ˆäº</div><div class="stat-value profit">+8,330</div></div>
            <div class="stat-item"><div class="stat-label">èƒœç‡</div><div class="stat-value">62%</div></div>
        </div>

        <div class="card">
            <h4 style="margin:0 0 1rem 0">ğŸ“ˆ èµ„äº§èµ°åŠ¿å›¾</h4>
            <div class="chart-container">
                <canvas id="assetChart"></canvas>
            </div>
        </div>

        <h4 style="margin: 1.5rem 0 0.8rem 0.2rem">ğŸ“… å†å²å¤ç›˜</h4>
        <div id="history-list"></div>
    </div>

    <div id="view-detail" style="display: none;">
        <div class="card date-header">
            <input type="date" id="date-selector" onchange="loadDetail(this.value)">
            <h3 id="detail-date-display" style="margin:0; font-size: 1.1rem;">é€‰æ‹©æ—¥æœŸæŸ¥çœ‹è¯¦æƒ…</h3>
        </div>

        <div class="stats-grid">
            <div class="stat-item"><div class="stat-label">å½“æ—¥ç›ˆäº</div><div id="detail-profit" class="stat-value">--</div></div>
            <div class="stat-item"><div class="stat-label">ç¬”æ•°</div><div id="detail-count" class="stat-value">0</div></div>
        </div>

        <div class="card">
            <h4 style="margin:0 0 1rem 0">ğŸ“œ äº¤æ˜“æ˜ç»† (å·¦å³æ»‘åŠ¨æŸ¥çœ‹)</h4>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr><th>æ ‡çš„</th><th>åŠ¨ä½œ</th><th>ä»·æ ¼</th><th>ç›ˆäº</th><th>é€»è¾‘åæ€</th></tr>
                    </thead>
                    <tbody id="detail-table"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    // æ•°æ®é€»è¾‘ä¿æŒä¸å˜
    const tradeData = {
        "2023-10-27": { profit: "+5,230", count: 2, items: [
            { name: "èµ›åŠ›æ–¯", act: "ä¹°å…¥", price: "82.5", change: "+3.5%", note: "å½¢æ€çªç ´" },
            { name: "å®å¾·æ—¶ä»£", act: "å–å‡º", price: "192", change: "-1.8%", note: "ç ´ä½æ­¢æŸ" }
        ]},
        "2023-10-26": { profit: "-1,100", count: 1, items: [
            { name: "è´µå·èŒ…å°", act: "å–å‡º", price: "1750", change: "-0.5%", note: "ç¼©å‡ä»“ä½" }
        ]}
    };

    const assetCurve = [
        { d: '10-20', v: 100000 }, { d: '10-21', v: 102500 }, { d: '10-22', v: 101800 },
        { d: '10-23', v: 105000 }, { d: '10-24', v: 104200 }, { d: '10-26', v: 103100 },
        { d: '10-27', v: 108330 }
    ];

    function renderChart() {
        const ctx = document.getElementById('assetChart').getContext('2d');
        const maxVal = Math.max(...assetCurve.map(o => o.v));
        
        new Chart(ctx, {
            type: 'line',
            plugins: [ChartDataLabels],
            data: {
                labels: assetCurve.map(o => o.d),
                datasets: [{
                    data: assetCurve.map(o => o.v),
                    borderColor: '#2563eb',
                    backgroundColor: 'rgba(37, 99, 235, 0.05)',
                    fill: true,
                    tension: 0.4,
                    pointRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    datalabels: {
                        align: 'top',
                        formatter: (v) => (v/1000).toFixed(1) + 'k',
                        font: { size: 10, weight: 'bold' },
                        color: (c) => c.raw === maxVal ? '#ef4444' : '#94a3b8'
                    }
                },
                scales: {
                    y: { ticks: { font: { size: 10 } }, grid: { color: '#f1f5f9' } },
                    x: { ticks: { font: { size: 10 } }, grid: { display: false } }
                }
            }
        });
    }

    function switchView(view) {
        document.getElementById('view-home').style.display = view === 'home' ? 'block' : 'none';
        document.getElementById('view-detail').style.display = view === 'detail' ? 'block' : 'none';
        document.getElementById('nav-home').className = view === 'home' ? 'active' : '';
        document.getElementById('nav-detail').className = view === 'detail' ? 'active' : '';
    }

    function loadDetail(date) {
        const data = tradeData[date];
        const table = document.getElementById('detail-table');
        document.getElementById('detail-date-display').innerText = date + " å¤ç›˜æ€»ç»“";
        if(data) {
            document.getElementById('detail-profit').innerText = "Â¥" + data.profit;
            document.getElementById('detail-profit').className = "stat-value " + (data.profit.includes('+') ? 'profit' : 'loss');
            document.getElementById('detail-count').innerText = data.count;
            table.innerHTML = data.items.map(i => `
                <tr>
                    <td><b>${i.name}</b></td>
                    <td><span class="badge ${i.act==='ä¹°å…¥'?'background:#ef4444':'background:#2563eb'}">${i.act}</span></td>
                    <td>${i.price}</td>
                    <td class="${i.change.includes('+')?'profit':'loss'}">${i.change}</td>
                    <td style="color:#64748b; font-size:0.75rem">${i.note}</td>
                </tr>
            `).join('');
        } else {
            table.innerHTML = `<tr><td colspan="5" style="text-align:center; padding:2rem; color:#94a3b8">æš‚æ— æ•°æ®</td></tr>`;
        }
    }

    function renderHistory() {
        const container = document.getElementById('history-list');
        container.innerHTML = Object.keys(tradeData).reverse().map(date => `
            <div class="history-item" onclick="quickView('${date}')">
                <span style="font-size:0.95rem; font-weight:600">${date}</span>
                <span class="${tradeData[date].profit.includes('+')?'profit':'loss'}" style="font-weight:800">
                    ${tradeData[date].profit} >
                </span>
            </div>
        `).join('');
    }

    function quickView(date) {
        document.getElementById('date-selector').value = date;
        loadDetail(date);
        switchView('detail');
    }

    window.onload = () => {
        renderChart();
        renderHistory();
        loadDetail("2023-10-27");
    };
</script>

</body>
</html>
